#!/bin/sh -e
command=$1
shift
case $command in
  (clone)
    cd "$DATA/2-standards/dev/aur"
    git -c init.defaultBranch=master clone ssh://aur@aur.archlinux.org/$1.git
    cd "$1"
    test -f PKGBUILD || sed "s/PKG/${1%%-git}/" ../PKGBUILD > PKGBUILD
    test -f .gitignore || echo '*' > .gitignore
    exec $SHELL;;
  (create)
    git add -f .gitignore PKGBUILD
    git commit -m "Create package" "$@"
    git aur push --amend;;
  (push)
    makepkg --printsrcinfo > .SRCINFO
    git add -f .SRCINFO
    git commit -v -a "$@"
    git push;;
esac

